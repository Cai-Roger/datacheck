import streamlit as st

st.set_page_config(
    page_title="操作說明｜Excel 比對程式",
    layout="wide"
)

st.title("📘 Excel 比對程式－操作說明")

st.markdown("""
---

## 一、工具用途
本工具用於比對 **兩份 Excel（A 與 B）** 的資料差異，  
支援：
- 多 Key 欄位
- 嚴格比對（空白 / 換行 / Tab 皆算差異）
- Excel B 多檔合併比對
- 差異結果匯出

---

## 二、操作流程

### 1️⃣ 上傳檔案
- **Excel A**：上傳 1 份
- **Excel B**：可上傳 1～多份（系統會自動合併）

> ⚠️ 請確保 Excel A 與 B 的表頭名稱一致

---

### 2️⃣ 設定 Key 欄位
- 從下拉選單勾選 Key（可多選）
- Key 用於資料對齊，不影響內容欄位的嚴格比對

---

### 3️⃣ 開始比對
點擊：
> 🟢 開始差異比對

系統會自動：
- 檢查重複 Key
- 比對所有欄位差異
- 產出 Summary / 差異明細

---

### 4️⃣ 下載結果
- 下載 Excel 檔
- 檔名自動包含：
  - 比對 Key
  - 台灣時間（YYYYMMDD_HHMMSS）
  - 流水號（避免覆蓋）

---

## 三、比對規則說明（重要）

### ✅ 嚴格模式
以下情況 **都會被判定為差異**：

| A 值 | B 值 | 是否算差異 |
|---|---|---|
| `ABC` | `ABC␣` | ✅ |
| `ABC` | `ABC↵` | ✅ |
| `A\tB` | `A B` | ✅ |
| 空白 | `<NaN>` | ✅ |

---

## 四、輸出檔案說明

| Sheet | 說明 |
|---|---|
| Summary | 比對總覽、Key、差異數 |
| ColumnDiff | A/B 欄位差異 |
| A_to_B | A 對 B 差異 |
| B_to_A | B 對 A 差異 |

---

## 五、常見注意事項

- 建議比對前先統一：
  - 欄位名稱
  - 資料型態（數字 / 文字）
- 若資料量大（>10 萬列），請耐心等待

---

## 六、版本資訊
- 工具版本：V2.0
- 時區：Asia/Taipei
- 比對核心：嚴格模式（Strict Compare）

---
""")

st.info("如有問題，請聯繫 QQ資料製作小組")
